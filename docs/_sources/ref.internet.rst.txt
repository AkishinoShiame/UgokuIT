.. _ref.internet:

=============================
Old.3. ネットワーク・管理
=============================

TCP/IP
=========

+-------+------------------------+----------------------+
|       | レイヤーと名前         | 簡単説明             |
|       +---------+--------------+----------------------+
|       | Layer 7 | Application  |                      |
|       +---------+--------------+                      |
| OSI   | Layer 6 | Presentation | アップリケーション   |
|       +---------+--------------+                      |
|       | Layer 5 | Session      |                      |
|       +---------+--------------+----------------------+
|       | Layer 4 | Transport    | TCP/UDP ポートとか   |
|       +---------+--------------+----------------------+
| MODEL | Layer 3 | Network      | IPアドレスなど       |
|       +---------+--------------+----------------------+
|       | Layer 2 | Data Link    | MACアドレスなど      |
|       +---------+--------------+----------------------+
|       | Layer 1 | Physical     | ハードウェアケーブル |
+-------+---------+--------------+----------------------+


フィジカル (Layer1)
======================

ネットワークのフィジカルはinternet packetを転送するの為に使うハードウェアです。

現在の技術としては二つ回線があります。

* Copper (カッパー)
* Fiber （光ファイバ）

**Copper Network**

カッパーを使って構築のネットワークは、電を使ってパケットを交換する。
この方法は室内電話からの回路をネット応用な設置です。

二つの銅線を使って、１ペアの回線が立ち上がります。

実際はアップロード・ダウロードが別々の実体線が必要です。だから１ペアが回線です。

この技術はISPが確認したのは、一つの回線のMax　Speedは 50Mです。　物理として電気も減衰しますから、実際の状況はギリギリ50Mが限界です。

大分の構築は2の回線を同時に使用し、100Mの回線プランが限界。　だから今時代としての必要が厳しいから、光に希望として頼ります。

**Fiber Network**

光ファイバーを導入するのネットワークは、光を使ってパケットを交換する。
この技術は回線をSpeedUpともっと効率的に使用したいな解決案です。

実際にも二つの光が必要です、一つはアップロード、もう一つはダウロード。ペアとして組み合わせの回線です。

技術の進展から、今の光ファイバーは１ファイバーで複数な回線を使用可能です。

そうして、ＩＳＰが立ち上がるの光回線のスピードは100M以上できます。


パケットSwitching (Layer2)
============================

Switchingとは、MACアドレス間の交換、VLAN技術でネット分離です。

MACアドレス
--------------

MACアドレスは、生産者がハードウェアを作った時に付けあげたのアドレスです。

普通に見える場所は、IP・ネットがサポートありの機械です。他にも使う事があります、たとえbluetoothやWiFiです。

MACアドレスは「Media Access Control address」の略称です。実際に48ビットの長さ、表示方法はHEXとしてプリントされる。

実際に使えるのタイプは二つがあります。

* **ローカルMAC**

  ローカルとして、ネットワーク機械の管理者が管理必要としてアレンジしたのアドレスです。

  基準として、以下のアドレスを編列できます。

  +-----------------------------+
  | x2 - xx - xx - xx - xx - xx |
  +-----------------------------+
  | x6 - xx - xx - xx - xx - xx |
  +-----------------------------+
  | xA - xx - xx - xx - xx - xx |
  +-----------------------------+
  | xE - xx - xx - xx - xx - xx |
  +-----------------------------+

*　**ユニヴァーサルMAC**

  これは世界通用のMAC アドレスです。

  ハードウェア製造者が付けるアドレス。

  基準も世界の色んな組織が標準を立ち上がりました。

  MACアドレスの前半はOUIと呼ばれる、各組織のユニークなIDです。ここからどうな工場やブランドが製造者が分かります。

  MACアドレスの後半は組織によって、自己編成できます。

  だから、こちらのサイトで、ハードウェアの製作者が検索できます：

他に、MACアドレスの放送(検索)アドレスは ``FF:FF:FF:FF:FF:FF`` です。

MACの使え方法は、同じ所・場所・ルームに接続な設備はSwitchがお互いのアドレスを知る為に、検索とテーブルとして記録される。
そのテーブルは「CAM Table」や「MAC Address Table」と呼ばれる。

こうなると、ローカルのパケッジ交換がもっと効率で完全できます。

* MAC tableはPCでも検査可能です。

Mac/Linux/Windows、全てのコマンドは``arp -a``


VLAN技術
------------

VLANは、Virtual Local Area Networkの略称です。つまり、LANを仮想化するの技術です。

この技術の重要性に付いて話前に、LANが実際の動くを話します。

LANはMACアドレスを使って、コミュニケーションが出来ます。この技術は、全てのLANが同じSwitchで繋がないといけない。

つまり、下の構造での表現がLANです。

.. image:: https://imgur.com/lAH6hiY.png

図から見ると、問題は無さそうですけど、実際にネットを立ち上がる時はこうなる：

.. image:: https://imgur.com/2C4BRF3.png

機械の認識は２つのLANが別々で立ち上がります。この場合、もし左のパソコンや設備が右のと連絡（繋がる）時は、なにも設定しないと、接続出来ない。

この状況は、VLANが必要です。　全てを仮想化で、みんなが繋がれる。

技術からと述べるなら、SwitchとSwitchの間に、trunk tunnelを構築、全てのパケットをタッグにする。そうすると、みんなは同じロジカルSwitchを繋いてます。

設定の部分は、Switchに設置で大丈夫です。

そうすると、構造はこうになった：

.. image:: https://imgur.com/mf4Xvc9.png

そうして、仮想化だから、指定のパソコンや設備をグループとして、別々のLANを分離するも可能です。

.. image:: https://imgur.com/Mk6ihh7.png

主のコマンドは：

  ``switchport mode trunk``

  ``switchport trunk native vlan <vlan-id>``


パケットRouting (Layer3)
==========================

Routingは、IPの配属、分割とMACをもっとインターネットの範囲にサポートする為の存在。

ゼロから世界まで、展開も繋がるも可能です。

IPの世界にも、プライベート（ローカル）と、パブリック（インターネット）との概念があります。

現時点のIPも、IPv4とIPv6この二つのメインバージョンが有ります。


IP・マスク・ゲートウェイ
---------------------------


IPv4
-------


IPv6
-------


レーヤー４以上
================


Windows 10のNetwork Indicatorを弄る
-------------------------------------

地球のオフライン状態で、パソコンアイコンのオンライ状態になるにはローカルのDNSとサーバーを以下の設置が必要です。

サーバーにconnecttest.txtのファイルが必要です。

そうして社内のDNSにwww.msftconnecttest.comをサーバーにredirectする。

設置した後、Windows 10のNetwork Indicatorは常にオンラインです。

